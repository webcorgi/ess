<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESS CARE 시스템 대시보드</title>
    <link rel="stylesheet" href="design.css">
</head>
<body>
    <!-- 미니맵 -->
    <div id="minimap" class="minimap">
        <div class="minimap-header">
            <div class="minimap-title">
                <span>🗺️</span>
                <span>전체 시스템 맵</span>
            </div>
            <button class="minimap-toggle" onclick="toggleMinimap()">
                <span id="minimapToggleIcon">−</span>
            </button>
        </div>
        <div class="minimap-content" id="minimapContent">
            <!-- JavaScript로 동적 생성 -->
        </div>
        <div class="minimap-stats">
            <div class="minimap-stat">
                <div class="minimap-stat-label">총 배터리</div>
                <div class="minimap-stat-value">3,780</div>
            </div>
            <div class="minimap-stat">
                <div class="minimap-stat-label">경고</div>
                <div class="minimap-stat-value alert" id="minimapAlertCount">0</div>
            </div>
            <div class="minimap-stat">
                <div class="minimap-stat-label">평균 SOC</div>
                <div class="minimap-stat-value">82%</div>
            </div>
            <div class="minimap-stat">
                <div class="minimap-stat-label">가동률</div>
                <div class="minimap-stat-value">99.8%</div>
            </div>
        </div>
    </div>

    <!-- 헤더 -->
    <div class="header">
        <div class="header-content">
            <div class="logo">
                <img src="./img/logo.png" alt="logo" class="logo-image">
            </div>
            <div class="nav-breadcrumb">
                <span id="breadcrumb">전체시스템</span>
            </div>
            <div class="status-bar">
                <div class="status-item">
                    <div class="status-indicator normal"></div>
                    <span>정상: <span id="normalCount">7</span></span>
                </div>
                <div class="status-item">
                    <div class="status-indicator alert"></div>
                    <span>경고: <span id="alertCount">2</span></span>
                </div>
            </div>
        </div>
    </div>

    <div class="container">

        
        <!-- 통계 패널 -->
        <div class="stats-container">
            <img src="./img/ess.png" alt="ess-system" class="ess-image">
            <div class="stats-panel">
            <div class="stat-card">
                <div class="stat-label">시스템 가동률</div>
                <div class="stat-value" id="avgAvailability">98.7%<span class="stat-trend">정상</span></div>
            </div>
            <div class="stat-card">
                <div class="stat-label">평균 RTE (왕복효율)</div>
                <div class="stat-value" id="avgRTE">93.5%<span class="stat-trend">▲ 0.3%</span></div>
            </div>
            <div class="stat-card">
                <div class="stat-label">일일 CO₂ 감축</div>
                <div class="stat-value" id="totalCO2">24.8톤<span class="stat-trend">▲ 2.1톤</span></div>
            </div>
            <div class="stat-card">
                <div class="stat-label">일일 비용 절감</div>
                <div class="stat-value" id="totalSaving">162만<span class="stat-trend">▲ 8.2%</span></div>
            </div>
            <div class="stat-card">
                <div class="stat-label">재생에너지 연계율</div>
                <div class="stat-value" id="avgRenewable">72.3%<span class="stat-trend">태양광</span></div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Peak Shaving</div>
                <div class="stat-value" id="avgPeakShaving">89.2%<span class="stat-trend">효율</span></div>
            </div>
            </div>
        </div>

        <!-- ESS 그리드 뷰 (항공뷰) -->
        <div id="essGridView" class="ess-grid">
            <div class="grid-container" id="essGrid">
                <!-- JavaScript로 동적 생성 -->
            </div>
        </div>

        <!-- 배터리 상세 뷰 -->
        <div id="batteryDetailView" class="battery-detail-view">
            <button class="back-button" onclick="showESSGrid()">
                ← ESS 목록으로 돌아가기
            </button>
            <h2 style="margin-bottom: 20px;">
                <span id="selectedESSName">ESS-01</span> 배터리 상태
            </h2>
            <div class="battery-grid" id="batteryGrid">
                <!-- JavaScript로 동적 생성 -->
            </div>
        </div>
    </div>

    <!-- 배터리 상세 팝업 -->
    <div id="batteryPopup" class="popup-overlay">
        <div class="popup-content">
            <div class="popup-header">
                <div>
                    <span class="popup-title" id="popupBatteryId">배터리 B-001</span>
                    <span id="popupStatus" class="battery-status-badge normal">정상</span>
                </div>
                <button class="close-button" onclick="closeBatteryPopup()">×</button>
            </div>
            
            <div class="battery-details">
                <div class="detail-item">
                    <div class="detail-label">전압 (Voltage)</div>
                    <div class="detail-value" id="popupVoltage">3.85V</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">전류 (Current)</div>
                    <div class="detail-value" id="popupCurrent">25.4A</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">온도 (Temperature)</div>
                    <div class="detail-value" id="popupTemp">28.5°C</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">충전상태 (SOC)</div>
                    <div class="detail-value" id="popupSOC">85%</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">건강상태 (SOH)</div>
                    <div class="detail-value" id="popupSOH">98%</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">사이클 수</div>
                    <div class="detail-value" id="popupCycles">342</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">방전깊이 (DoD)</div>
                    <div class="detail-value" id="popupDoD">70%</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">내부저항</div>
                    <div class="detail-value" id="popupResistance">2.8mΩ</div>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">최근 1시간 전압 추이</div>
                <div class="chart-bars">
                    <div class="chart-bar" style="height: 70%"><span class="chart-label">10분</span></div>
                    <div class="chart-bar" style="height: 75%"><span class="chart-label">20분</span></div>
                    <div class="chart-bar" style="height: 80%"><span class="chart-label">30분</span></div>
                    <div class="chart-bar" style="height: 78%"><span class="chart-label">40분</span></div>
                    <div class="chart-bar" style="height: 85%"><span class="chart-label">50분</span></div>
                    <div class="chart-bar" style="height: 82%"><span class="chart-label">60분</span></div>
                </div>
            </div>
        </div>
    </div>

    <!-- 툴팁 -->
    <div id="tooltip" class="tooltip"></div>


    <script src="script.js"></script>
</body>
</html>